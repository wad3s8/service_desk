--
-- PostgreSQL database dump
--

-- Dumped from database version 17.4
-- Dumped by pg_dump version 17.4

SET statement_timeout = 0;
SET lock_timeout = 0;
SET idle_in_transaction_session_timeout = 0;
SET transaction_timeout = 0;
SET client_encoding = 'UTF8';
SET standard_conforming_strings = on;
SELECT pg_catalog.set_config('search_path', '', false);
SET check_function_bodies = false;
SET xmloption = content;
SET client_min_messages = warning;
SET row_security = off;

SET default_tablespace = '';

SET default_table_access_method = heap;

--
-- Name: categories; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.categories (
    id bigint NOT NULL,
    name character varying(100) NOT NULL
);


ALTER TABLE public.categories OWNER TO service_desk;

--
-- Name: categories_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.categories ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.categories_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: locations; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.locations (
    id bigint NOT NULL,
    active boolean NOT NULL,
    name character varying(255) NOT NULL,
    type character varying(255) NOT NULL,
    parent_id bigint,
    CONSTRAINT locations_type_check CHECK (((type)::text = ANY ((ARRAY['OFFICE'::character varying, 'REGION'::character varying, 'FEDERATION'::character varying])::text[])))
);


ALTER TABLE public.locations OWNER TO service_desk;

--
-- Name: locations_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.locations ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.locations_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: refresh_tokens; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.refresh_tokens (
    id bigint NOT NULL,
    expires_at timestamp(6) with time zone NOT NULL,
    ip character varying(45),
    revoked boolean NOT NULL,
    rotated_at timestamp(6) with time zone,
    token_hash character varying(88) NOT NULL,
    user_agent character varying(255),
    user_id bigint NOT NULL
);


ALTER TABLE public.refresh_tokens OWNER TO service_desk;

--
-- Name: refresh_tokens_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.refresh_tokens ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.refresh_tokens_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: roles; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.roles (
    id bigint NOT NULL,
    name character varying(50) NOT NULL
);


ALTER TABLE public.roles OWNER TO service_desk;

--
-- Name: roles_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.roles ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.roles_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: subcategories; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.subcategories (
    id bigint NOT NULL,
    default_skill_id bigint,
    name character varying(100) NOT NULL,
    category_id bigint NOT NULL
);


ALTER TABLE public.subcategories OWNER TO service_desk;

--
-- Name: subcategories_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.subcategories ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.subcategories_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: subcategory_sla; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.subcategory_sla (
    id bigint NOT NULL,
    resolve_minutes bigint NOT NULL,
    subcategory_id bigint NOT NULL
);


ALTER TABLE public.subcategory_sla OWNER TO service_desk;

--
-- Name: subcategory_sla_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.subcategory_sla ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.subcategory_sla_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: team_locations; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.team_locations (
    id bigint NOT NULL,
    responsibility_type character varying(255),
    location_id bigint NOT NULL,
    team_id bigint NOT NULL
);


ALTER TABLE public.team_locations OWNER TO service_desk;

--
-- Name: team_locations_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.team_locations ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.team_locations_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: team_member_skills; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.team_member_skills (
    id bigint NOT NULL,
    subcategory_id bigint NOT NULL,
    team_member_id bigint NOT NULL
);


ALTER TABLE public.team_member_skills OWNER TO service_desk;

--
-- Name: team_member_skills_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.team_member_skills ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.team_member_skills_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: team_members; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.team_members (
    id bigint NOT NULL,
    active boolean NOT NULL,
    role character varying(255) NOT NULL,
    team_id bigint NOT NULL,
    user_id bigint NOT NULL,
    CONSTRAINT team_members_role_check CHECK (((role)::text = ANY ((ARRAY['AGENT'::character varying, 'MANAGER'::character varying])::text[])))
);


ALTER TABLE public.team_members OWNER TO service_desk;

--
-- Name: team_members_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.team_members ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.team_members_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: teams; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.teams (
    id bigint NOT NULL,
    active boolean NOT NULL,
    code character varying(255),
    name character varying(255) NOT NULL
);


ALTER TABLE public.teams OWNER TO service_desk;

--
-- Name: teams_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.teams ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.teams_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: ticket_attachments; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.ticket_attachments (
    id bigint NOT NULL,
    content_type character varying(255) NOT NULL,
    filename character varying(255) NOT NULL,
    size bigint NOT NULL,
    storage_key character varying(255) NOT NULL,
    uploaded_at timestamp(6) with time zone NOT NULL,
    ticket_id bigint NOT NULL,
    uploaded_by bigint NOT NULL
);


ALTER TABLE public.ticket_attachments OWNER TO service_desk;

--
-- Name: ticket_attachments_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.ticket_attachments ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.ticket_attachments_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: ticket_comments; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.ticket_comments (
    id bigint NOT NULL,
    created_at timestamp(6) with time zone NOT NULL,
    system_comment boolean NOT NULL,
    text character varying(2000) NOT NULL,
    updated_at timestamp(6) with time zone NOT NULL,
    author_id bigint NOT NULL,
    ticket_id bigint NOT NULL
);


ALTER TABLE public.ticket_comments OWNER TO service_desk;

--
-- Name: ticket_comments_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.ticket_comments ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.ticket_comments_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: ticket_history; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.ticket_history (
    id bigint NOT NULL,
    action character varying(30) NOT NULL,
    comment character varying(512),
    created_at timestamp(6) with time zone NOT NULL,
    new_value character varying(255),
    old_value character varying(255),
    performed_by bigint NOT NULL,
    ticket_id bigint NOT NULL
);


ALTER TABLE public.ticket_history OWNER TO service_desk;

--
-- Name: ticket_history_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.ticket_history ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.ticket_history_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: tickets; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.tickets (
    id bigint NOT NULL,
    created_at timestamp(6) with time zone NOT NULL,
    description character varying(512) NOT NULL,
    location character varying(255),
    priority character varying(20) NOT NULL,
    resolved_at timestamp(6) with time zone,
    status character varying(30) NOT NULL,
    title character varying(255) NOT NULL,
    updated_at timestamp(6) with time zone NOT NULL,
    assignee_id bigint,
    requester_id bigint NOT NULL,
    subcategory_id bigint,
    assigned_team_id bigint,
    location_id bigint NOT NULL,
    resolve_breached_at timestamp(6) with time zone,
    resolve_due_at timestamp(6) with time zone NOT NULL,
    CONSTRAINT tickets_priority_check CHECK (((priority)::text = ANY ((ARRAY['LOW'::character varying, 'MEDIUM'::character varying, 'HIGH'::character varying])::text[]))),
    CONSTRAINT tickets_status_check CHECK (((status)::text = ANY ((ARRAY['NEW'::character varying, 'IN_PROGRESS'::character varying, 'RESOLVED'::character varying, 'CLOSED'::character varying, 'CANCELED'::character varying])::text[])))
);


ALTER TABLE public.tickets OWNER TO service_desk;

--
-- Name: tickets_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.tickets ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.tickets_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Name: user_roles; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.user_roles (
    user_id bigint NOT NULL,
    role_id bigint NOT NULL
);


ALTER TABLE public.user_roles OWNER TO service_desk;

--
-- Name: users; Type: TABLE; Schema: public; Owner: service_desk
--

CREATE TABLE public.users (
    id bigint NOT NULL,
    email character varying(320) NOT NULL,
    enabled boolean NOT NULL,
    first_name character varying(100),
    is_admin boolean NOT NULL,
    last_name character varying(100),
    locked boolean NOT NULL,
    password_hash character varying(100) NOT NULL,
    phone character varying(32),
    "position" character varying(100),
    workplace character varying(255),
    location_id bigint
);


ALTER TABLE public.users OWNER TO service_desk;

--
-- Name: users_id_seq; Type: SEQUENCE; Schema: public; Owner: service_desk
--

ALTER TABLE public.users ALTER COLUMN id ADD GENERATED BY DEFAULT AS IDENTITY (
    SEQUENCE NAME public.users_id_seq
    START WITH 1
    INCREMENT BY 1
    NO MINVALUE
    NO MAXVALUE
    CACHE 1
);


--
-- Data for Name: categories; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.categories (id, name) FROM stdin;
1	Здание и конструкции
2	Окна, двери, доступ
3	Электрика и свет
\.


--
-- Data for Name: locations; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.locations (id, active, name, type, parent_id) FROM stdin;
1	t	ЕКБ регион	REGION	\N
2	t	Екатеринбург, ул. Горького, д. 7а	OFFICE	1
3	t	Москва, пр-т Андропова, д. 18, стр. 3	OFFICE	1
4	t	Санкт-Петербург, Малый проспект Петроградской стороны, д. 87	OFFICE	1
\.


--
-- Data for Name: refresh_tokens; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.refresh_tokens (id, expires_at, ip, revoked, rotated_at, token_hash, user_agent, user_id) FROM stdin;
1	2026-01-27 15:40:49.959498+05	0:0:0:0:0:0:0:1	f	\N	hfSNy8oL5taVSA1kqVQjeSaS+ItMtAIoj6sdC8vBRyA=	PostmanRuntime/7.51.0	6
2	2026-01-27 15:41:00.84917+05	0:0:0:0:0:0:0:1	f	\N	V8RKEod8cPhrfiHMS5nL8BySVCPhCLMMWzfW65bfGWo=	PostmanRuntime/7.51.0	1
3	2026-01-27 15:48:56.896722+05	0:0:0:0:0:0:0:1	f	\N	ZDWMiExJhQ4M4g9ckGbR6BkQrcUB75qINkkUd3M7JDA=	PostmanRuntime/7.51.0	5
4	2026-01-27 16:08:02.792937+05	0:0:0:0:0:0:0:1	f	\N	JOme16s1CEFYDvEtYnWbaVgq+G+2mM7MqsOZ8cCzyO4=	PostmanRuntime/7.51.0	2
5	2026-01-27 16:27:11.848938+05	0:0:0:0:0:0:0:1	f	\N	ZnhOtr8sHOwq9GhFwqO7IeqvGaBMBO1R2AuBWxkPWJM=	PostmanRuntime/7.51.0	5
6	2026-01-28 22:33:48.920594+05	0:0:0:0:0:0:0:1	f	\N	ceLBWg50VbFvjpEJq6OLLBrT2kUwxjl5PIImhGlqu/I=	PostmanRuntime/7.51.0	2
7	2026-01-28 22:35:42.907415+05	0:0:0:0:0:0:0:1	f	\N	J2sTq3mau16gplwRPlVcvuBG5SvHDiw3cd9oC381bIs=	PostmanRuntime/7.51.0	2
8	2026-01-28 22:51:12.992441+05	0:0:0:0:0:0:0:1	f	\N	vUIhF7zByTwnsrWgYcTnzToGY6j7d3bVGddNsH5ZI1g=	PostmanRuntime/7.51.0	2
9	2026-01-28 22:55:10.263973+05	0:0:0:0:0:0:0:1	f	\N	nhFOf1vqf6egsMMOsJxexnLgEyu6wbp6dU9mhxmXbzw=	PostmanRuntime/7.51.0	1
10	2026-01-28 23:14:14.311492+05	0:0:0:0:0:0:0:1	f	\N	GQRPbHDCGTxQlKxsz6t2hyOazjVewepvXZm31Dogt7Q=	PostmanRuntime/7.51.0	5
11	2026-01-29 00:07:16.528294+05	0:0:0:0:0:0:0:1	f	\N	u2Ak+1wETnKcjOADK7km/ipYkiwBQQw1eCEAwmC/JT0=	PostmanRuntime/7.51.0	1
12	2026-01-29 01:05:21.283199+05	0:0:0:0:0:0:0:1	f	\N	zmI+bgQxr6dnibvOdP/ezcix0L776NGiAV1xzrQXhYg=	PostmanRuntime/7.51.0	1
\.


--
-- Data for Name: roles; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.roles (id, name) FROM stdin;
2	executor
1	customer
4	supervisor
3	aho_head
\.


--
-- Data for Name: subcategories; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.subcategories (id, default_skill_id, name, category_id) FROM stdin;
2	\N	Стены и перегородки	1
1	\N	Потолки	1
3	\N	Полы и покрытия	1
4	\N	Окна	2
5	\N	Двери	2
6	\N	Замки	2
7	\N	Розетки	3
8	\N	Выключатели	3
9	\N	Освещение	3
\.


--
-- Data for Name: subcategory_sla; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.subcategory_sla (id, resolve_minutes, subcategory_id) FROM stdin;
3	2880	7
2	2880	4
1	2880	1
\.


--
-- Data for Name: team_locations; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.team_locations (id, responsibility_type, location_id, team_id) FROM stdin;
1	\N	2	1
\.


--
-- Data for Name: team_member_skills; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.team_member_skills (id, subcategory_id, team_member_id) FROM stdin;
3	7	3
2	4	2
1	1	1
\.


--
-- Data for Name: team_members; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.team_members (id, active, role, team_id, user_id) FROM stdin;
1	t	AGENT	1	2
2	t	AGENT	1	3
3	t	AGENT	1	4
4	t	MANAGER	1	5
\.


--
-- Data for Name: teams; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.teams (id, active, code, name) FROM stdin;
1	t	12	ЕКБ офис на Горького
\.


--
-- Data for Name: ticket_attachments; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.ticket_attachments (id, content_type, filename, size, storage_key, uploaded_at, ticket_id, uploaded_by) FROM stdin;
\.


--
-- Data for Name: ticket_comments; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.ticket_comments (id, created_at, system_comment, text, updated_at, author_id, ticket_id) FROM stdin;
\.


--
-- Data for Name: ticket_history; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.ticket_history (id, action, comment, created_at, new_value, old_value, performed_by, ticket_id) FROM stdin;
\.


--
-- Data for Name: tickets; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.tickets (id, created_at, description, location, priority, resolved_at, status, title, updated_at, assignee_id, requester_id, subcategory_id, assigned_team_id, location_id, resolve_breached_at, resolve_due_at) FROM stdin;
\.


--
-- Data for Name: user_roles; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.user_roles (user_id, role_id) FROM stdin;
1	1
2	2
3	2
4	2
5	3
6	4
7	1
\.


--
-- Data for Name: users; Type: TABLE DATA; Schema: public; Owner: service_desk
--

COPY public.users (id, email, enabled, first_name, is_admin, last_name, locked, password_hash, phone, "position", workplace, location_id) FROM stdin;
7	system@service-desk	t	string	f	string	f	$2a$10$hrEAAMzLEg5t122Iz1gSiurWEIWl38ir2U/pnBsrK/kiqS06yxX.y	\N	\N	\N	\N
1	customer@example.com	t	Дмитрий	f	Кузнецов	f	$2a$10$uGNaZwM8ornRbHHYqvrp1ubYKiv3yhaN4uxvvup9ZI3kLN.FCxnVu	89321657891	\N	1	\N
2	executor1@example.com	t	Илья	f	Попов	f	$2a$10$cDdHiXdUDOjUY8mPDP9nN.yRCZV52aMeSjrriSUMUiOc28p/F/l/y	89223474365	\N	3	\N
5	aho@example.com	t	Александр	f	Петров	f	$2a$10$b4JypDZwys7M2iKraqPipOIwmYph6AnWCefr3qpnuCPcRjHbjujqu	89341575801	\N	5	\N
6	supervisor@example.com	t	Владислав	f	Соколов	f	$2a$10$mGLygfpaOAg0KNTSkWAM..wVD5JFngFLHcCGscgUVCRoTXRGt5sCm	89224784338	\N	12	\N
3	executor2@example.com	t	Виктор	f	Михайлов	f	$2a$10$DB7nHQgO4bXMkYUZY3gH9.kw2XJoehywZCvU/7r30YCBm/1tf99Eu	\N	\N	\N	\N
4	executor3@example.com	t	Кирилл	f	Иванов	f	$2a$10$iQbT33CGld6uyjg6YsShuOV4r5dWievCgD1ElhfD2hl79Kz000q7S	\N	\N	\N	\N
\.


--
-- Name: categories_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.categories_id_seq', 1, false);


--
-- Name: locations_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.locations_id_seq', 1, false);


--
-- Name: refresh_tokens_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.refresh_tokens_id_seq', 12, true);


--
-- Name: roles_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.roles_id_seq', 1, false);


--
-- Name: subcategories_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.subcategories_id_seq', 1, false);


--
-- Name: subcategory_sla_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.subcategory_sla_id_seq', 1, false);


--
-- Name: team_locations_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.team_locations_id_seq', 1, false);


--
-- Name: team_member_skills_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.team_member_skills_id_seq', 1, false);


--
-- Name: team_members_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.team_members_id_seq', 1, false);


--
-- Name: teams_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.teams_id_seq', 1, false);


--
-- Name: ticket_attachments_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.ticket_attachments_id_seq', 1, false);


--
-- Name: ticket_comments_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.ticket_comments_id_seq', 1, false);


--
-- Name: ticket_history_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.ticket_history_id_seq', 19, true);


--
-- Name: tickets_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.tickets_id_seq', 6, true);


--
-- Name: users_id_seq; Type: SEQUENCE SET; Schema: public; Owner: service_desk
--

SELECT pg_catalog.setval('public.users_id_seq', 7, true);


--
-- Name: categories categories_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT categories_pkey PRIMARY KEY (id);


--
-- Name: locations locations_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.locations
    ADD CONSTRAINT locations_pkey PRIMARY KEY (id);


--
-- Name: refresh_tokens refresh_tokens_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.refresh_tokens
    ADD CONSTRAINT refresh_tokens_pkey PRIMARY KEY (id);


--
-- Name: roles roles_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT roles_pkey PRIMARY KEY (id);


--
-- Name: subcategories subcategories_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategories
    ADD CONSTRAINT subcategories_pkey PRIMARY KEY (id);


--
-- Name: subcategory_sla subcategory_sla_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategory_sla
    ADD CONSTRAINT subcategory_sla_pkey PRIMARY KEY (id);


--
-- Name: team_locations team_locations_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_locations
    ADD CONSTRAINT team_locations_pkey PRIMARY KEY (id);


--
-- Name: team_member_skills team_member_skills_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_member_skills
    ADD CONSTRAINT team_member_skills_pkey PRIMARY KEY (id);


--
-- Name: team_members team_members_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_members
    ADD CONSTRAINT team_members_pkey PRIMARY KEY (id);


--
-- Name: teams teams_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.teams
    ADD CONSTRAINT teams_pkey PRIMARY KEY (id);


--
-- Name: ticket_attachments ticket_attachments_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_attachments
    ADD CONSTRAINT ticket_attachments_pkey PRIMARY KEY (id);


--
-- Name: ticket_comments ticket_comments_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_comments
    ADD CONSTRAINT ticket_comments_pkey PRIMARY KEY (id);


--
-- Name: ticket_history ticket_history_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_history
    ADD CONSTRAINT ticket_history_pkey PRIMARY KEY (id);


--
-- Name: tickets tickets_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT tickets_pkey PRIMARY KEY (id);


--
-- Name: ticket_attachments uk6kiofh73jp4utt146cde8qpvi; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_attachments
    ADD CONSTRAINT uk6kiofh73jp4utt146cde8qpvi UNIQUE (storage_key);


--
-- Name: team_locations ukavquv7367odamdhf8po2710hm; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_locations
    ADD CONSTRAINT ukavquv7367odamdhf8po2710hm UNIQUE (team_id, location_id);


--
-- Name: team_member_skills ukibjec8s51d1exkbnf7ifo9bjr; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_member_skills
    ADD CONSTRAINT ukibjec8s51d1exkbnf7ifo9bjr UNIQUE (team_member_id, subcategory_id);


--
-- Name: team_members uks8nuwsa7nvebc246ed822w68x; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_members
    ADD CONSTRAINT uks8nuwsa7nvebc246ed822w68x UNIQUE (team_id, user_id);


--
-- Name: categories ukt8o6pivur7nn124jehx7cygw5; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.categories
    ADD CONSTRAINT ukt8o6pivur7nn124jehx7cygw5 UNIQUE (name);


--
-- Name: user_roles user_roles_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT user_roles_pkey PRIMARY KEY (user_id, role_id);


--
-- Name: users users_pkey; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT users_pkey PRIMARY KEY (id);


--
-- Name: roles ux_roles_name; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.roles
    ADD CONSTRAINT ux_roles_name UNIQUE (name);


--
-- Name: refresh_tokens ux_rt_token_hash; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.refresh_tokens
    ADD CONSTRAINT ux_rt_token_hash UNIQUE (token_hash);


--
-- Name: subcategories ux_subcategories_category_name; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategories
    ADD CONSTRAINT ux_subcategories_category_name UNIQUE (category_id, name);


--
-- Name: subcategory_sla ux_subcategory_sla_subcategory; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategory_sla
    ADD CONSTRAINT ux_subcategory_sla_subcategory UNIQUE (subcategory_id);


--
-- Name: users ux_users_email; Type: CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT ux_users_email UNIQUE (email);


--
-- Name: ix_rt_expires; Type: INDEX; Schema: public; Owner: service_desk
--

CREATE INDEX ix_rt_expires ON public.refresh_tokens USING btree (expires_at);


--
-- Name: ix_rt_user; Type: INDEX; Schema: public; Owner: service_desk
--

CREATE INDEX ix_rt_user ON public.refresh_tokens USING btree (user_id);


--
-- Name: ix_users_phone; Type: INDEX; Schema: public; Owner: service_desk
--

CREATE INDEX ix_users_phone ON public.users USING btree (phone);


--
-- Name: team_locations fk8dojsnpjhlpijdt45bnex6655; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_locations
    ADD CONSTRAINT fk8dojsnpjhlpijdt45bnex6655 FOREIGN KEY (team_id) REFERENCES public.teams(id);


--
-- Name: ticket_attachments fk_attachment_ticket; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_attachments
    ADD CONSTRAINT fk_attachment_ticket FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: ticket_attachments fk_attachment_uploaded_by; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_attachments
    ADD CONSTRAINT fk_attachment_uploaded_by FOREIGN KEY (uploaded_by) REFERENCES public.users(id);


--
-- Name: ticket_comments fk_comment_author; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_comments
    ADD CONSTRAINT fk_comment_author FOREIGN KEY (author_id) REFERENCES public.users(id);


--
-- Name: ticket_comments fk_comment_ticket; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_comments
    ADD CONSTRAINT fk_comment_ticket FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: ticket_history fk_history_ticket; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_history
    ADD CONSTRAINT fk_history_ticket FOREIGN KEY (ticket_id) REFERENCES public.tickets(id);


--
-- Name: ticket_history fk_history_user; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.ticket_history
    ADD CONSTRAINT fk_history_user FOREIGN KEY (performed_by) REFERENCES public.users(id);


--
-- Name: refresh_tokens fk_rt_user; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.refresh_tokens
    ADD CONSTRAINT fk_rt_user FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: subcategories fk_subcategory_category; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategories
    ADD CONSTRAINT fk_subcategory_category FOREIGN KEY (category_id) REFERENCES public.categories(id);


--
-- Name: subcategory_sla fk_subcategory_sla_subcategory; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.subcategory_sla
    ADD CONSTRAINT fk_subcategory_sla_subcategory FOREIGN KEY (subcategory_id) REFERENCES public.subcategories(id);


--
-- Name: tickets fk_ticket_assignee; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk_ticket_assignee FOREIGN KEY (assignee_id) REFERENCES public.users(id);


--
-- Name: tickets fk_ticket_location; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk_ticket_location FOREIGN KEY (location_id) REFERENCES public.locations(id);


--
-- Name: tickets fk_ticket_requester; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk_ticket_requester FOREIGN KEY (requester_id) REFERENCES public.users(id);


--
-- Name: tickets fk_ticket_subcategory; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk_ticket_subcategory FOREIGN KEY (subcategory_id) REFERENCES public.subcategories(id);


--
-- Name: tickets fk_ticket_team; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.tickets
    ADD CONSTRAINT fk_ticket_team FOREIGN KEY (assigned_team_id) REFERENCES public.teams(id);


--
-- Name: team_member_skills fk_tms_member; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_member_skills
    ADD CONSTRAINT fk_tms_member FOREIGN KEY (team_member_id) REFERENCES public.team_members(id);


--
-- Name: team_member_skills fk_tms_subcategory; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_member_skills
    ADD CONSTRAINT fk_tms_subcategory FOREIGN KEY (subcategory_id) REFERENCES public.subcategories(id);


--
-- Name: user_roles fk_ur_role; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT fk_ur_role FOREIGN KEY (role_id) REFERENCES public.roles(id);


--
-- Name: user_roles fk_ur_user; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.user_roles
    ADD CONSTRAINT fk_ur_user FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: users fk_user_location; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.users
    ADD CONSTRAINT fk_user_location FOREIGN KEY (location_id) REFERENCES public.locations(id);


--
-- Name: team_members fkee8x7x5026imwmma9kndkxs36; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_members
    ADD CONSTRAINT fkee8x7x5026imwmma9kndkxs36 FOREIGN KEY (user_id) REFERENCES public.users(id);


--
-- Name: team_locations fkh2s238f0bxi42isdo404erpyf; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_locations
    ADD CONSTRAINT fkh2s238f0bxi42isdo404erpyf FOREIGN KEY (location_id) REFERENCES public.locations(id);


--
-- Name: locations fkhjdkpuoptx1cd04r3atchkpi0; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.locations
    ADD CONSTRAINT fkhjdkpuoptx1cd04r3atchkpi0 FOREIGN KEY (parent_id) REFERENCES public.locations(id);


--
-- Name: team_members fktgca08el3ofisywcf11f0f76t; Type: FK CONSTRAINT; Schema: public; Owner: service_desk
--

ALTER TABLE ONLY public.team_members
    ADD CONSTRAINT fktgca08el3ofisywcf11f0f76t FOREIGN KEY (team_id) REFERENCES public.teams(id);


--
-- PostgreSQL database dump complete
--

